{% unless page.content and page.content contains "<div" %}
<!-- WebPage -->
{% assign web_page_blocks = page.content | parse_json %}
{%- assign article_body = '' -%}

{% for item in web_page_blocks -%}
    {% if item.type == 'settings' %}
        {% assign page_settings = item -%}
    {% else %}
        {%- assign article_body = article_body | append item.title -%}
        {%- assign article_body = article_body | append item.subtitle -%}
        {%- assign article_body = article_body | append item.note -%}
        {%- assign article_body = article_body | append item.paragraph -%}
    {% endif %}
{% endfor -%}

<script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type":"WebPage",
    {% if page_settings.markup_webpage_title %}
        "name": "{{- page_settings.markup_webpage_title -}}",
    {% elsif page_title != '' %}
        "name": "{{- page_title -}}",
    {% else %}
        "name": "ASP.NET ecommerce platform - Virto Commerce",
    {% endif %}
    {% if page_settings.markup_webpage_description %}
        "description": "{{- page_settings.markup_webpage_description | escape -}}",
    {% elsif page_description != '' %}
        "description": "{{- page_description | escape -}}",
    {% else %}
        "description": "VirtoCommerce is the enterprise-level Microsoft .NET ecommerce platform for complex ecommerce. Virto Commerce is a flexible B2B ecommerce solution based on Microsoft.NET that offers powerful tools for enterprise business users.",
    {% endif %}
    "url": "{{- settings.markup_corporation_url -}}{{- page_settings.permalink -}}",
    "mainEntityOfPage": "{{- settings.markup_corporation_url -}}{{- page_settings.permalink -}}",
    "inLanguage": "en_us",
    {% if current_page.meta_info["header"] | first %}
        "headline": "{{- current_page.meta_info["header"] | first -}}",
    {% elsif page_title != '' %}
        "headline": "{{- page_title -}}",
    {% else %}
        "headline": "ASP.NET ecommerce platform - Virto Commerce",
    {% endif %}
    "author": {
        "@type": "Corporation",
        "name": "{{- settings.markup_corporation_name -}}",
        "url": "{{- settings.markup_corporation_url -}}",
        "location": {
            "@type": "Place",
            "name": "{{- settings.markup_corporation_name -}}",
            "url": "{{- settings.markup_corporation_url -}}" 
        }
    },
    "copyrightHolder": {
        "@type": "Corporation",
        "name": "{{- settings.markup_corporation_name -}}",
        "url": "{{- settings.markup_corporation_url -}}",
        "location": {
            "@type": "Place",
            "name": "{{- settings.markup_corporation_name -}}",
            "url": "{{- settings.markup_corporation_url -}}" 
        }
    },
    "text": "{{ article_body | strip_html }}",
    "image": {
        "@type": "ImageObject",
        {% if page_settings.markup_webpage_image %}
            "url": "{{- page_settings.markup_webpage_image -}}",
        {% else %}
            "url": "{{- settings.markup_website_default_image -}}",
        {% endif %}
        "width": 600,
        "height": 400
    },
    "publisher": {
        "@type": "Corporation",
        "name": "{{- settings.markup_corporation_name -}}",
        "url": "{{- settings.markup_corporation_url -}}",
        "location": {
            "@type": "Place",
            "name": "{{- settings.markup_corporation_name -}}",
            "url": "{{- settings.markup_corporation_url -}}" 
        }
    }
}
</script>
{% endunless %}
